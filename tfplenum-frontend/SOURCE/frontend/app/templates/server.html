
<script>
  // Adding this allows this code to be identified in a browser debugger
  //@ sourceURL=server.js
  $(document).ready(function(){

    // The event object generated here represents the input field of the checkbox
    // selected. target is the DOM element that initated the event. See: https://learn.jquery.com/events/event-basics/
    // The object in this case will be an HTMLInputElement. The parent class of this,
    // Element, has the attribute ID.
    {% for i in range(server_count) %}
    $("#{{ ['is_master_server', i+1] | join('_') }}").change(event, function() {

      // This loops over each checkbox this ISN'T the checkbox that was clicked
      // and flips its disabled status to be the opposite of what it currently is.
      // This has the effect of only allowing one of the master server checkboxes
      // to be selected at any given time.
      $( ".master_server_checkbox" ).not( "#" + event.target.id ).each(function() {
        // This checks to see if the checkbox is or is not already disabled
        // If it is, it flips it to be the opposite.
        // See: https://stackoverflow.com/questions/14913845/jquery-checking-for-disabled-attribute-and-adding-removing-it
        if($(this).is(':disabled')){
          $( "#" + this.id ).prop( "disabled", false );
        } else {
          $( "#" + this.id ).prop( "disabled", true );
        }
      });
    })
    {% endfor %}
  });
</script>

<div class="card">
  <div class="card-header">
    Total Server Resources
  </div>
  <div class="card-body">
    <p class="card-text">CPUs Available: <span id="server_cpus_available"></span></p>
    <p class="card-text">Memory Available: <span id="server_memory_available"></span></p>
    <p class="card-text">Drive Space Available: <span id="server_disk_space_available"></span></p>
    <a href="#" class="btn btn-primary">Gather Facts for All Servers</a>
  </div>
</div>
{# This loop goes from 0 to server_count #}
{% for i in range(server_count) %}
<div class="server_slide card">
  <div class="card-header" id="{{ ['server_accordion_header', i+1] | join('_') }}">
    <h5 class="mb-0">
      <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#{{ ['server_collapse', i+1] | join('_') }}" aria-expanded="true" aria-controls="{{ ['server_collapse', i+1] | join('_') }}">
        Server {{ i + 1 }}
      </button>
    </h5>
  </div>
  <div id="{{ ['server_collapse', i+1] | join('_') }}" class="c-ollapse show" aria-labelledby="{{ ['server_accordion_header', i+1] | join('_') }}">
    <div class="card-body">
      {% with object = form.host_server.change_values(
        (['server_form', i+1] | join('_')),
         (form.host_server.field_id + '_' + ((i+1) | string)),
         (form.host_server.button_id + '_' + ((i+1) | string))) %}
         {% include "button.html" %}
      {% endwith %}
      <form id='{{ ['server_form', i+1] | join('_') }}' role=form class="needs-validation" novalidate>
      <div class="form-check">
        <input class="form-check-input master_server_checkbox" type="checkbox" value="" id="{{ ['is_master_server', i+1] | join('_') }}">
        <label id='{{ ['is_master_server_label', i+1] | join('_') }}' class="form-check-label" for="{{ ['is_master_server', i+1] | join('_') }}">
          {{ form.server_is_master_server_checkbox.label }}
        </label>
      </div>
      <a href="{{ url_for('help') + '#anchor_' + form.server_is_master_server_checkbox.label | replace(' ','_') }}">
        <label>What is this?</label>
      </a>
      </form>
    </div>
  </div>
</div>
{% endfor %}
