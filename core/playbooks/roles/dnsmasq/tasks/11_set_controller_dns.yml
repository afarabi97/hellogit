---

- name: Get Controller Interface Name
  shell: |
    ip -o addr | grep {{ ansible_default_ipv4.address }} | awk '{ print $2 }'
  register: controller_interface_name

- name: Remove DNS line from interface script
  shell: |
    sed -i '/^DNS/ d' /etc/sysconfig/network-scripts/ifcfg-*
  args:
    warn: false

- name: Add DNS to interface script
  lineinfile:
    dest: /etc/sysconfig/network-scripts/ifcfg-{{ controller_interface_name.stdout }}
    line: "DNS1={{ hostvars[groups['master_server'][0]].management_ipv4 }}"
    state: present
  notify:
    - "Restart Network"
    - "Restart NetworkManager"

...
