
---

- name: Deploy Zeek Index Template
  uri:
    url: "https://{{elastic_fqdn}}:{{elastic_port}}/_template/template_zeek"
    method: PUT
    validate_certs: no
    user: "{{default_elastic_user}}"
    password: "{{ es_password.stdout }}"
    body_format: json
    body: "{{ lookup('file', 'files/zeek-pipeline/template_zeek')}}"
    status_code: 200, 201

- name: Zeek Pipeline
  uri:
    url: "https://{{elastic_fqdn}}:{{elastic_port}}/_ingest/pipeline/{{ item[item.rfind('/')+1:] }}"
    method: PUT
    validate_certs: no
    user: "{{default_elastic_user}}"
    password: "{{ es_password.stdout }}"
    body_format: json
    body: "{{ lookup('file', '{{ item }}')}}"
    status_code: 200, 201
  with_fileglob:
    - "files/zeek-pipeline/zeek_*"

...
