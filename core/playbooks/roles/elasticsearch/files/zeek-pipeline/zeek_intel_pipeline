{
    "description": "Zeek Intel pipeline",
    "processors": [
        {
            "pipeline": {
                "name": "zeek_general_network_pipeline"
            }
        },
        {
            "set": {
                "field": "event.category",
                "value": "network"
            }
        },
        {
            "rename": {
                "field": "proto",
                "target_field": "network.transport"
            }
        },
        {
            "rename": {
                "field": "fuid",
                "target_field": "log.id.fuid"
            }
        },
        {
            "rename": {
                "field": "file_mime_type",
                "target_field": "file.mime_type",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "file_desc",
                "target_field": "intel.file_description"
            }
        },
        {
            "rename": {
                "field": "matched",
                "target_field": "intel.matched"
            }
        },
        {
            "set": {
                "field": "intel.seen.indicator",
                "value": "{{seen.indicator}}"
            }
        },
        {
            "set": {
                "field": "intel.seen.indicator_type",
                "value": "{{seen.indicator_type}}"
            }
        },
        {
            "set": {
                "field": "intel.seen.ip",
                "value": "{{seen.host}}"
            }
        },
        {
            "set": {
                "field": "intel.seen.node",
                "value": "{{seen.node}}"
            }
        },
        {
            "set": {
                "field": "intel.seen.where",
                "value": "{{seen.where}}"
            }
        },
        {
            "set": {
                "field": "intel.seen.sources",
                "value": "{{seen.sources}}"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.sources"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.where"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.node"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.host"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.indicator_type"
            }
        },
        {
            "dot_expander": {
                "field": "intel.seen.indicator"
            }
        },
        {
            "remove": {
                "ignore_missing": true,
                "field": [
                    "seen.sources",
                    "seen.where",
                    "seen.node",
                    "seen.host",
                    "seen.indicator_type",
                    "seen.indicator"
                ]
            }
        }
    ],
    "on_failure": [
        {
            "set": {
                "field": "error.message",
                "value": "{{ _ingest.on_failure_message }}"
            }
        }
    ]
}
