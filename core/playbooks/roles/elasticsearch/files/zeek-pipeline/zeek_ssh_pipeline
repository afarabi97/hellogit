{
    "description": "Zeek SSH pipeline",
    "processors": [
        {
            "pipeline": {
                "name": "zeek_general_network_pipeline"
            }
        },
        {
            "set": {
                "field": "event.category",
                "value": "network"
            }
        },
        {
            "set": {
                "field": "source.software.original",
                "value": "{{client}}"
            }
        },
        {
            "rename": {
                "field": "direction",
                "target_field": "network.direction",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "auth_attempts",
                "target_field": "ssh.authentication.attempts"
            }
        },
        {
            "set": {
                "field": "event.outcome",
                "value": "success",
                "if": "(ctx.auth_success == true)",
                "ignore_failure": true
            }
        },
        {
            "set": {
                "field": "event.outcome",
                "value": "failure",
                "if": "(ctx.auth_success == false)",
                "ignore_failure": true
            }
        },
        {
            "rename": {
                "field": "auth_success",
                "target_field": "ssh.authentication.successful",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "cipher_alg",
                "target_field": "tls.cipher",
                "ignore_missing": true
            }
        },
        {
            "set": {
                "field": "ssh.algorithm.cipher",
                "value": "{{tls.cipher}}"
            }
        },
        {
            "rename": {
                "field": "compression_alg",
                "target_field": "ssh.algorithm.compression",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "host_key",
                "target_field": "ssh.host_key",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "host_key_alg",
                "target_field": "ssh.algorithm.host_key",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "kex_alg",
                "target_field": "ssh.algorithm.key_exchange",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "mac_alg",
                "target_field": "ssh.algorithm.mac",
                "ignore_missing": true
            }
        },
        {
            "set": {
                "field": "destination.software.original",
                "value": "{{server}}"
            }
        },
        {
            "rename": {
                "field": "version",
                "target_field": "ssh.version",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "hassh",
                "target_field": "ssh.hassh",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "hasshAlgorithms",
                "target_field": "ssh.hasshAlgorithms",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "hasshServer",
                "target_field": "ssh.hasshServer",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "hasshServerAlgorithms",
                "target_field": "ssh.hasshServerAlgorithms",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "sshka",
                "target_field": "ssh.sshka",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "cshka",
                "target_field": "ssh.cshka",
                "ignore_missing": true
            }
        },
        {
            "set": {
                "field": "network.transport",
                "value": "tcp"
            }
        },
        {
            "remove": {
                "ignore_missing": true,
                "field": [
                    "id",
                    "server",
                    "client"
                ]
            }
        }
    ],
    "on_failure": [
        {
            "set": {
                "field": "error.message",
                "value": "{{ _ingest.on_failure_message }}"
            }
        }
    ]
}
