{
    "description": "Zeek Software pipeline",
    "processors": [
        {
            "set": {
                "field": "event.category",
                "value": "observations"
            }
        },
        {
            "rename": {
                "field": "version_addl",
                "target_field": "software.additional",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "host",
                "target_field": "software.ip",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "host_p",
                "target_field": "software.port",
                "ignore_missing": true
            }
        },
        {
            "set": {
                "field": "version_major",
                "value": "{{version.major}}"
            }
        },
        {
            "set": {
                "field": "version_minor",
                "value": "{{version.minor}}"
            }
        },
        {
            "set": {
                "field": "version_minor2",
                "value": "{{version.minor2}}"
            }
        },
        {
            "set": {
                "field": "version_minor3",
                "value": "{{version.minor3}}"
            }
        },
        {
            "rename": {
                "field": "version_major",
                "target_field": "software.major",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "version_minor",
                "target_field": "software.minor",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "version_minor2",
                "target_field": "software.minor2",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "version_minor3",
                "target_field": "software.minor3",
                "ignore_missing": true
            }
        },
        {
            "dot_expander": {
                "field": "software.version.minor",
                "ignore_failure": true
            }
        },
        {
            "dot_expander": {
                "field": "software.version.major",
                "ignore_failure": true
            }
        },
        {
            "dot_expander": {
                "field": "software.version.minor2",
                "ignore_failure": true
            }
        },
        {
            "dot_expander": {
                "field": "software.version.minor3",
                "ignore_failure": true
            }
        },
        {
            "remove": {
                "ignore_missing": true,
                "field": [
                    "version.minor",
                    "version.minor2",
                    "version.minor3",
                    "version.major",
                    "seen.indicator_type",
                    "seen.indicator"
                ]
            }
        },
        {
            "rename": {
                "field": "name",
                "target_field": "software.name",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "unparsed_version",
                "target_field": "software.original",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "software_type",
                "target_field": "software.type",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "url",
                "target_field": "url.original",
                "ignore_missing": true
            }
        }
    ],
    "on_failure": [
        {
            "set": {
                "field": "error.message",
                "value": "{{ _ingest.on_failure_message }}"
            }
        }
    ]
}
