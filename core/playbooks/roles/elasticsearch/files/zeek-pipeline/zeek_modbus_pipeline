{
    "description": "Zeek Modbus pipeline",
    "processors": [
        {
            "pipeline": {
                "name": "zeek_general_network_pipeline"
            }
        },
        {
            "set": {
                "field": "event.category",
                "value": "network"
            }
        },
        {
            "set": {
                "field": "network.protocol",
                "value": "modbus"
            }
        },
        {
            "rename": {
                "field": "proto",
                "target_field": "network.transport",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "func",
                "target_field": "modbus.function",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "exception",
                "target_field": "modbus.exception",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "track_address",
                "target_field": "modbus.track_address",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "delta",
                "target_field": "modbus.delta",
                "ignore_missing": true
            }
        },
        {
            "convert": {
                "field": "modbus.delta",
                "type": "float",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "new_val",
                "target_field": "modbus.new_value",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "old_val",
                "target_field": "modbus.old_value",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "register",
                "target_field": "modbus.register",
                "ignore_missing": true
            }
        }
    ],
    "on_failure": [
        {
            "set": {
                "field": "error.message",
                "value": "{{ _ingest.on_failure_message }}"
            }
        }
    ]
}
