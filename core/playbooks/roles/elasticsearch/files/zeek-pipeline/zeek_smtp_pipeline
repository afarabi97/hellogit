{
    "description": "Zeek SMTP pipeline",
    "processors": [
        {
            "pipeline": {
                "name": "zeek_general_network_pipeline"
            }
        },
        {
            "set": {
                "field": "event.category",
                "value": "network"
            }
        },
        {
            "rename": {
                "field": "fuids",
                "target_field": "log.id.fuids",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "cc",
                "target_field": "smtp.cc",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "first_received",
                "target_field": "smtp.first_received",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "from",
                "target_field": "smtp.from",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "helo",
                "target_field": "smtp.helo",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "in_reply_to",
                "target_field": "smtp.in_reply_to",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "is_webmail",
                "target_field": "smtp.is_webmail",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "last_reply",
                "target_field": "smtp.last_reply",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "mailfrom",
                "target_field": "smtp.mail_from",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "msg_id",
                "target_field": "smtp.msg_id",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "path",
                "target_field": "smtp.path",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "rcptto",
                "target_field": "smtp.rcpt_to",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "reply_to",
                "target_field": "smtp.reply_to",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "second_received",
                "target_field": "smtp.second_received",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "subject",
                "target_field": "smtp.subject",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "tls",
                "target_field": "smtp.tls",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "to",
                "target_field": "smtp.to",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "trans_depth",
                "target_field": "smtp.transaction_depth",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "x_originating_ip",
                "target_field": "smtp.x_originating_ip",
                "ignore_missing": true
            }
        },
        {
            "rename": {
                "field": "user_agent",
                "target_field": "smtp.user_agent",
                "ignore_missing": true
            }
        },
        {
            "date": {
                "field": "date",
                "target_field": "smtp.date",
                "formats": [
                    "ISO8601"
                ],
                "ignore_failure": true
            }
        },
        {
            "remove": {
                "field": "date",
                "ignore_missing": true
            }
        },
        {
            "set": {
                "field": "network.transport",
                "value": "tcp"
            }
        },
        {
            "set": {
                "field": "network.protocol",
                "value": "smtp"
            }
        }
    ],
    "on_failure": [
        {
            "set": {
                "field": "error.message",
                "value": "{{ _ingest.on_failure_message }}"
            }
        }
    ]
}
