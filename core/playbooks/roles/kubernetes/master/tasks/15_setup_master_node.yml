---
# By default the cluster will not scehdule pods on the master for security reasons.
# The below task removes that restriction.
- name: 'Remove master taint from master'
  command: 'kubectl taint nodes --all node-role.kubernetes.io/master-'
  changed_when: true
  ignore_errors: yes

- name: 'Label masters'
  command: 'kubectl label nodes {{ ansible_fqdn }} role=server --overwrite=true'
  changed_when: true

- name: 'Label masters'
  command: 'kubectl label nodes {{ ansible_fqdn }} dedicated=master --overwrite=true'
  changed_when: true
