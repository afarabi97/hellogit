---

- name: Yum Utils Check
  command: rpm -qa yum-utils
  register: results
  args:
    warn: false
  changed_when: false

- name: Clean Yum Transactions
  shell: "yum-complete-transaction --cleanup-only && yum clean all"
  when: results.stdout.find('is not installed') != -1

- name: Install packages
  dnf:
    name: "{{ package_list }}"
    state: installed

- name: upgrade pip
  pip:
    name:
    - pip
    - setuptools
    state: present

- name: Install Pip Modules
  pip:
    name: "{{ pip_installs }}"
    state: present

...
