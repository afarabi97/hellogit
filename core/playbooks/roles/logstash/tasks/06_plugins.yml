---

- name: "Create directory"
  file:
    path: "{{ logstash_dir }}/plugins"
    mode: u+rw,g+rw
    owner: "{{ logstash_user }}"
    group: "{{ logstash_group }}"
    state: directory
    recurse: yes

- name: Copy plugins
  copy:
    src: "{{ item }}"
    dest: "{{ logstash_dir }}/plugins/{{ item | basename }}"
    owner: "{{ logstash_user }}"
    group: "{{ logstash_group }}"
    mode: 0644
  with_fileglob: "files/plugins/*"

...
