---
- name: Removing instances of nullok from /etc/pam.d/system-auth
  replace:
    path: /etc/pam.d/system-auth
    regexp: 'nullok'

- name: Removing instances of nullok from /etc/pam.d/password-auth
  replace:
    path: /etc/pam.d/password-auth
    regexp: 'nullok'

- name: Updating password requirements
  replace:
    path: /etc/pam.d/system-auth
    regexp: 'authtok_type='
    replace: "authtok_type= - 'dcredit=-1 ocredit=-1 ucredit=-1 difok=3 retry=3'"

- name: Making passwords expire after 60 days
  replace:
    path: /etc/login.defs
    regexp: 'PASS_MAX_DAYS\t99999'
    replace: "PASS_MAX_DAYS\t60"

- name: Making 1 day in between password changes
  replace:
    path: /etc/login.defs
    regexp: 'PASS_MIN_DAYS\t0'
    replace: "PASS_MIN_DAYS\t1"

- name: Making minimum password length 14 characters
  replace:
    path: /etc/login.defs
    regexp: 'PASS_MIN_LEN\t5'
    replace: "PASS_MIN_LEN\t14"
