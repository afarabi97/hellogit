---
- name: Copying login/ssh banner message and CVA/H Logo to MIP
  copy:
    src: "{{ item['src'] }}"
    dest: "{{ item['dest'] }}"
    owner: root
    group: root
    mode: '0755'
  with_items:
    - { src: '/root/Files_To_Be_Copied_Over/etc/dconf/db/gdm.d/01-banner-message', dest: '/etc/dconf/db/gdm.d/'}
    - { src: '/root/Files_To_Be_Copied_Over/etc/dconf/db/gdm.d/01-login-screen', dest: '/etc/dconf/db/gdm.d/'}
    - { src: '/root/Files_To_Be_Copied_Over/etc/issue.net', dest: '/etc/'}
    - { src: '/root/Files_To_Be_Copied_Over/usr/local/share/pixmaps/cvah-logo.png', dest: '/usr/local/share/pixmaps/'}

- name: Setting desktop icon size
  become: yes
  become_user: "{{ item }}"
  command: dbus-launch dconf write /org/gnome/nautilus/icon-view/default-zoom-level "'standard'"
  register: result
  changed_when: result.rc == 0
  failed_when:  result.rc > 0
  loop:
    - assessor
    - root
    - maintainer
    - usaf_admin
    - 911admin
    - auditor

- name: Setting screen lock when idle/inactive to off
  become: yes
  become_user: "{{ item }}"
  command: dbus-launch dconf write /org/gnome/settings-daemon/plugins/power/idle-dim false
  register: result
  changed_when: result.rc == 0
  failed_when:  result.rc > 0
  loop:
    - assessor
    - root
    - maintainer
    - usaf_admin
    - 911admin
    - auditor

- name: Setting screen timeout delay to never
  become: yes
  become_user: "{{ item }}"
  command: dbus-launch dconf write /org/gnome/desktop/session/idle-delay 'uint32 0'
  register: result
  changed_when: result.rc == 0
  failed_when:  result.rc > 0
  loop:
    - assessor
    - root
    - maintainer
    - usaf_admin
    - 911admin
    - auditor

- name: Updating ssh banner path
  replace:
    path: /etc/ssh/sshd_config
    regexp: '#Banner none'
    replace: "Banner /etc/issue.net"

- name: Create hidden file for validation if playbooks crash
  file:
    path: /operator/.DO_NOT_DELETE/.041
    state: touch
...
