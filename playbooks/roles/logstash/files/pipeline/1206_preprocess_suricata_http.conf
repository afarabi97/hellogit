filter {
  if [type] == "suricata" and [http] {
    mutate {
      rename => { "[http][http_method]" => "method" }
      rename => { "[http][hostname]" => "virtual_host" }
      rename => { "[http][url]" => "uri" }
      rename => { "[http][protocol]" => "version" }
      rename => { "[http][http_user_agent]" => "useragent" }
      rename => { "[http][length]" => "response_body_length" }
      rename => { "[http][status]" => "status_code" }
      rename => { "[http][http_content_type]" => "resp_mime_types" }
      rename => { "[http][http_refer]" => "referrer" }

      gsub => [ "version", "HTTP/", "" ]

      add_tag => [ "suricata_http" ]
    }
  }
}
