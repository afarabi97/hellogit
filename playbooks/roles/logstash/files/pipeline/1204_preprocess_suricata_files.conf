filter {
  if [type] == "suricata" and [fileinfo] {
    mutate {
      rename => { "[fileinfo][filename]" => "file_name" }
      rename => { "[fileinfo][gaps]" => "file_gaps" }
      rename => { "[fileinfo][size]" => "total_bytes" }
      rename => { "[fileinfo][state]" => "file_state" }
      rename => { "[fileinfo][stored]" => "file_stored" }
      rename => { "[fileinfo][tx_id]" => "file_tx_id" }
      rename => { "[fileinfo][type]" => "file_type" }
      rename => { "[fileinfo][magic]" => "file_magic" }

      add_tag => [ "suricata_fileinfo" ]
    }

    if [http][http_content_type] {
      mutate {
        copy => { "[http][http_content_type]" => "mimetype" }
      }
    }
  }
}
