---
- name: Check if tfplenum vars exists
  stat:
    path: "{{ tfplenum_vars }}"
  register: vars_result

# TODO: This will install tfplenum rpm when its ready
# For now git clone the di2e repo to /opt/rock/tfplenum
#- name: Install tfplenum rpm
#  yum:
#    name: tfplenum
#    state: present
#  when: vars_result.stat.exists == false

#- name: Check if tfplenum vars exists again
#  stat:
#    path: "{{ install_dir }}/tfplenum/group_vars/all/versions.yml"
#  register: vars_result

- name: Missing tfplenum repo
  fail:
    msg: "Missing tfplenum repo.  Please run tag setup"
  when: vars_result.stat.exists == false

- name: check for offline var
  fail:
    msg: "offline variable is missing.  Please review sample inventory."
  when: offline is not defined or offline is none

- name: offline and pull repos conflicting
  fail:
    msg: "Verify offline variable and pull_all_repos variable.  pull_all_repos cannot be true when offline is true."
  when: offline is defined and offline 
    and pull_all_repos is defined and pull_all_repos == true

- name: offline and pull repos conflicting
  fail:
    msg: "Verify offline variable and pull_additional_repos variable.  pull_additional_repos cannot be true when offline is true."
  when: offline is defined and offline 
    and pull_additional_repos is defined and pull_additional_repos == true

- name: offline and pull repos conflicting
  fail:
    msg: "Verify offline variable and pull_rhel_repos variable.  pull_rhel_repos cannot be true when offline is true."
  when: offline is defined and offline 
    and pull_rhel_repos is defined and pull_rhel_repos == true

- name: offline and pull repos conflicting
  fail:
    msg: "Verify offline variable and pull_centos_repos variable.  pull_centos_repos cannot be true when offline is true."
  when: offline is defined and offline 
    and pull_centos_repos is defined and pull_centos_repos == true