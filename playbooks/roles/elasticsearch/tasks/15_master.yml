- name: Create Config
  shell: |
    kubectl create configmap elastic-master --from-file {{ elastic_dir }}/{{ item }}
  with_items:
    - es-master-conf.yml

- name: Deploy ES Masters
  include_role:
    name: kubernetes/common
    tasks_from: kube_create
  vars:
    name: "Elasticsearch Masters"
    file_name: "{{ elastic_dir }}/{{ item }}"
  with_items:
    - es-master-svc.yml
    - es-master-deploy.yml

- name: Wait for Elasticsearch to be ready
  import_role:
    name: kubernetes/common
    tasks_from: kube_wait
  vars:
    type: "deployments"
    namespace: "default"
    resource_name: "es-master"
    label: ""
