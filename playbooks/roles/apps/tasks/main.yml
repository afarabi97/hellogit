---

- set_fact:
        cmd: !unsafe kubectl get pods -o go-template --template '{{range .items}}{{.metadata.name}}{{"\n"}}{{end}}'

- name: get pods
  shell: |
    {{ cmd }}
  register: get_pods
  changed_when: get_pods.failed

- name: Check Application Status
  include_tasks: app_test.yml 
  vars:
    pod_list: "{{ get_pods.stdout_lines }}"
    app_name: "{{ item }}"
  with_items:
  - "bro"
  - "suricata"
  - "moloch"

    
...