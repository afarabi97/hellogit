---
- name: 'Configure Kubelet'
  lineinfile:
    path: /etc/sysconfig/kubelet
    regexp: "^KUBELET_EXTRA_ARGS="
    line: "KUBELET_EXTRA_ARGS=--read-only-port 10255 --system-reserved cpu={{ hostvars[inventory_hostname].sys_cpu_reserve }}m,memory={{ hostvars[inventory_hostname].sys_mem_reserve }}Ki --kube-reserved cpu={{ hostvars[inventory_hostname].kube_cpu_reserve }}m,memory={{ hostvars[inventory_hostname].kube_mem_reserve }}Ki"
  notify: restart kubelet
