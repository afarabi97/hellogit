---

- name: Delete existing config directory
  file:
    path: "{{ suricata_dir }}"
    state: absent
    owner: root
    group: root
    mode: u+rw,g+rw

- name: Create config directory
  file:
    path: "{{ suricata_dir }}"
    state: directory
    owner: root
    group: root
    mode: u+rw,g+rw

- name: Copy Suricata configuration files
  include: 10_install_templates.yml hostname="{{ item[0] }}" filename="{{ item[1] }}"
  with_nested:
    - "{{ groups['sensors'] | union(groups['remote-sensors']) }}"
    - ['suricata.yaml', 'filebeat.yml', 'custom.rules', 'deploy.yml']

...