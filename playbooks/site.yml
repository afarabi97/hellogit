# site.yml is the overall playbook, but all it does is include the other playbooks that are part of the site. For more
# information about the structure see:
# http://docs.ansible.com/ansible/latest/playbooks_best_practices.html
# http://docs.ansible.com/ansible/latest/intro_inventory.html
# We follow the guidance to include naming conventions there.

---

- name: Verify tfplenum has been deployed
  hosts:
    - master-server
    - servers
    - sensors
    - remote-sensors
  gather_facts: no
  any_errors_fatal: true
  roles:
    - preflight
  tags: preflight

- name: Replay PCAPs
  hosts:
  - localhost
  gather_facts: yes
  any_errors_fatal: true
  roles:
    - replay
  tags: replay

- name: Verify kubernetes is healthy
  hosts: master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - kubernetes
  tags: kubernetes

- name: Verify ceph is healthy
  hosts: master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - ceph
  tags: ceph

- name: Validate Elasticsearch
  hosts:
  - master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - elasticsearch
  tags: elasticsearch

- name: Validate Bro
  hosts:
  - master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - bro
  tags: bro

- name: Validate Suricata
  hosts:
  - master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - suricata
  tags: suricata

- name: Validate Moloch
  hosts:
  - master-server
  gather_facts: no
  any_errors_fatal: true
  roles:
    - moloch
  tags: moloch
...
