---
- name: "Create directory for offline repos"
  file:
    path: "{{ tfplenumoffline_dir }}"
    state: directory
    mode: 0755
    owner: root
    group: root
    setype: httpd_sys_content_t

- name: "Create tfplenum repo directory"
  file:
    path: "{{ item }}"
    state: directory
  with_items:
    - "{{ TFPLENUM_REPO_DIR }}"

- name: "Install bootstrap packages"
  dnf:
    name: "{{ bootstrap_package_names }}"
    state: present

- name: Enable Firewalld Service
  service:
    name: "firewalld"
    state: started
    enabled: true

- name: Copy dirs from rhel iso
  delegate_to: "{{ inventory_hostname }}"
  synchronize:
    dest: "{{ TFPLENUM_REPO_DIR }}"
    src:  "{{ mnt_pth }}/"
    recursive: yes
    # rsync_opts:
    #   - "--exclude=AppStream"
    #   - "--exclude=BaseOS"

# - name: Copy BaseOS repodata from rhel iso
#   delegate_to: "{{ inventory_hostname }}"
#   synchronize:
#     dest: "{{ TFPLENUM_REPO_DIR }}/BaseOS"
#     src:  "{{ mnt_pth }}/BaseOS/Packages"
#     recursive: yes
#   when:
#     - "system_name == 'DIP' or system_name == 'GIP'"

# - name: Copy Treeinfo
#   copy:
#     src: files/treeinfo
#     dest: "{{ TFPLENUM_REPO_DIR }}/.treeinfo"
