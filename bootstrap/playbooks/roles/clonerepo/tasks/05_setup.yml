---
- name: "Create directory for offline repos"
  file:
    path: "{{ tfplenumoffline_dir }}"
    state: directory
    mode: 0755
    owner: root
    group: root
    setype: httpd_sys_content_t

- name: "Create tfplenum repo directory"
  file:
    path: "{{ item }}"
    state: directory
  with_items:
    - "{{ TFPLENUM_REPO_DIR }}"
    - "{{ tfplenumoffline_dir }}/beats/winlogbeat"
    - "{{ tfplenumoffline_dir }}/beats/filebeat"
    - "{{ tfplenumoffline_dir }}/beats/auditbeat"
    - "{{ tfplenumoffline_dir }}/beats/sysmon"
    - "{{ offline_cert_dir }}"

- name: "Install bootstrap packages"
  dnf:
    name: "{{ bootstrap_package_names }}"
    state: present
  when: not rpm_build

- name: Enable Firewalld Service
  service:
    name: "firewalld"
    state: started
    enabled: true
  when: not rpm_build

- name: Copy dirs from rhel iso
  shell: |
    7z x -aos -o{{ TFPLENUM_REPO_DIR }} {{ iso_rhel_path }}
  register: results
  changed_when: results.rc == 0
