---

- name: Remove Docker images
  block:
    - name: Get docker images
      command: docker images -q
      register: docker_images
      changed_when: docker_images.rc == 0
      
    - name: Remove docker images from docker after uploaded to registry
      command: "docker rmi -f {{ item }}"
      register: result
      ignore_errors: yes
      changed_when: result.rc == 0
      with_items:
        "{{ docker_images.stdout_lines }}"
  when:
    - "system_name == 'DIP' or system_name == 'GIP'"
  tags:
    - pull-docker-images
    - pull-helm-images

- name: Unmount iso from {{ mnt_pth }}
  mount:
    state: absent
    path: "{{ mnt_pth }}"

- name: Remove isos
  file:
    path: "{{ item }}"
    state: absent
  with_items:
   - "{{ iso_rhel_path }}"
