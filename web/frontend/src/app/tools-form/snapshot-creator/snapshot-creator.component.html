<mat-card>
  <mat-card-header>
    <mat-card-title>
      <a (click)="toggleCard()">
        <em class="material-icons" *ngIf="!isCardVisible">chevron_right</em>
        <em class="material-icons" *ngIf="isCardVisible">expand_more</em>
        <span style="vertical-align: top;">Elasticsearch Snapshots</span>
      </a>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content *ngIf="isCardVisible" fxLayout="column" fxLayoutAlign="start start">
    <ng-container *ngIf="setupProcessState === 'inprogress'">
      You have already initiated the setup job.  This process can take up to an hour to complete.
      Please check your notification manager for the message "Completed Elasticsearch repository registration".
      Once you see this message, refresh this page to begin taking snapshots of your data.
    </ng-container>
    <ng-container *ngIf="setupProcessState === 'notstarted'">
      The setup process for creating Elasticsearch snapshots has not been completed.
    </ng-container>
    <ng-container *ngIf="setupProcessState === 'complete'">
      <table mat-table [dataSource]="snapshots" aria-describedby="Snapshot table">
        <ng-container matColumnDef="name">
          <th scope="col" mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let snapshot">{{ snapshot.snapshot }}</td>
        </ng-container>

        <ng-container matColumnDef="state">
          <th scope="col" mat-header-cell *matHeaderCellDef>State</th>
          <td mat-cell *matCellDef="let snapshot">{{ snapshot.state }}</td>
        </ng-container>

        <ng-container matColumnDef="start_time">
          <th scope="col" mat-header-cell *matHeaderCellDef>Start Time</th>
          <td mat-cell *matCellDef="let snapshot">{{ snapshot.start_time }}</td>
        </ng-container>

        <ng-container matColumnDef="end_time">
          <th scope="col" mat-header-cell *matHeaderCellDef>End Time</th>
          <td mat-cell *matCellDef="let snapshot">{{ snapshot.end_time }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
        <tr mat-row *matRowDef="let myRowData; columns: displayColumns"></tr>
      </table>
      <mat-paginator #snapshotPaginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </ng-container>
  </mat-card-content>
  <mat-card-actions *ngIf="isCardVisible">
    <button *ngIf="setupProcessState === 'complete'" mat-raised-button color="primary"
      (click)="takeSnapShot()">Take Snapshot</button>
    <a *ngIf="setupProcessState === 'complete'" mat-raised-button color="primary"
       href="{{ kibanaLink }}/app/kibana#/management/elasticsearch/snapshot_restore/snapshots" target="_blank">Restore</a>
    <button *ngIf="setupProcessState === 'notstarted'" mat-raised-button color="primary" style="margin-top: 10px;" (click)="setup()">Setup</button>
  </mat-card-actions>
</mat-card>
