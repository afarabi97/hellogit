<h2 mat-dialog-title>Restore {{ data.title }}</h2>
<mat-dialog-content>
  <p>
    Please select an archived Kickstart form. Keep in mind restoring a form will
    remove your current configuration.
  </p>
  <div *ngIf="!showSelectedRow; else viewSelection">
    <table mat-table [dataSource]="dataSource" aria-describedby="Archive Table">
      <!-- Checkbox Column -->
      <ng-container matColumnDef="select">
        <th scope="col" mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox
            (click)="$event.stopPropagation()"
            (change)="$event ? selection.toggle(row) : null"
            [checked]="selection.isSelected(row)"
            disableRipple=true
          >
          </mat-checkbox>
        </td>
      </ng-container>

      <!-- Archive Date Column -->
      <ng-container matColumnDef="archived_date">
        <th scope="col" mat-header-cell *matHeaderCellDef>Archived Date</th>
        <td mat-cell *matCellDef="let element">{{ element.archive_date }}</td>
      </ng-container>

      <!-- Comment Column -->
      <ng-container matColumnDef="comment">
        <th scope="col" mat-header-cell *matHeaderCellDef>Comment</th>
        <td mat-cell *matCellDef="let element">{{ element.comment }}</td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th scope="col" mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <button
            mat-icon-button
            (click)="$event.stopPropagation()"
            [matMenuTriggerFor]="menu"
            [matMenuTriggerData]="{ row: element }"
            (menuOpened)="viewSelectedItem(element)"
          >
            <mat-icon>more_vert</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        (click)="selection.toggle(row)"
      ></tr>
    </table>

    <mat-paginator
      [pageSizeOptions]="[5, 10]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
  <ng-template #viewSelection>
    <button mat-icon-button color="primary" (click)="showSelectedRow = false">
      <mat-icon>keyboard_backspace</mat-icon>
    </button>
    <pre>
<code>{{ selection.selected[0] | json }}</code>
  </pre>
  </ng-template>
</mat-dialog-content>
<mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">
  <button mat-raised-button (click)="dialogRef.close()">Cancel</button>
  <button
    mat-raised-button
    color="primary"
    [mat-dialog-close]="selection.selected"
    [disabled]="selection.selected.length < 1"
  >
    Restore
  </button>
</mat-dialog-actions>

<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-row="row">
    <button
      mat-menu-item
      *ngIf="!delete"
      matTooltip="View archived {{ data.title }}"
      (click)="showSelectedRow = true"
    >
      <mat-icon>pageview</mat-icon><span>View</span>
    </button>
    <button
      mat-menu-item
      *ngIf="!delete"
      matTooltip="Delete this archived {{ data.title }}"
      (click)="delete = true; $event.stopPropagation()"
    >
      <mat-icon color="warn">delete</mat-icon><span>Delete</span>
    </button>
    <button
      mat-menu-item
      *ngIf="delete"
      matTooltip="Cencel Delete"
      (click)="delete = false; $event.stopPropagation()"
    >
      <mat-icon>cancel</mat-icon><span>Cancel</span>
    </button>
    <button
      mat-menu-item
      *ngIf="delete"
      matTooltip="Confirm Delete"
      (click)="delete = false; deleteArchive(row)"
    >
      <mat-icon color="warn">delete_forever</mat-icon><span>Confirm</span>
    </button>
  </ng-template>
</mat-menu>
