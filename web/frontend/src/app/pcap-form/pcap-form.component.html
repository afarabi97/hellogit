<div class="main-content2">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Page Instructions</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="pageInstructions">
        <p>
          This page allows you to upload PCAP files that can then be used to test your rules on the Rule Sets page.
          PCAP files uploaded this way, cannot exceed 100 MB in size.
          <br><br>
          If you are uploading a lot of PCAP files or you have PCAPs larger than 100 MB, you can drop them directly
          into
          /var/www/html/pcaps folder on the Controller VM and this page will auto load them in.
        </p>
      </div>
    </mat-card-content>
  </mat-card>
  <br>
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        PCAP Test Files
        <button mat-raised-button color="primary" (click)="uploadFile()" style="float: right;"
          [disabled]="!pcapToUpload" name="execute_kickstart">Upload
          <span *ngIf="pcapToUpload">&nbsp;{{ pcapToUpload.name }}</span></button>
        <button mat-raised-button color="primary" style="float:right; margin-right: 10px;" (click)="fileInput.click()">Choose PCAP File</button>
        <input hidden (change)="handleFileInput($event.target.files)" #fileInput type="file" id="pcap_file_uploader" accept=".pcap,.PCAP">
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <table mat-table [dataSource]="pcaps">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let pcap"> {{ pcap.name }}</td>
        </ng-container>
        <ng-container matColumnDef="mod_date">
          <th mat-header-cell *matHeaderCellDef>Modified Date</th>
          <td mat-cell *matCellDef="let pcap"> {{ pcap.createdDate }}</td>
        </ng-container>
        <ng-container matColumnDef="size">
          <th mat-header-cell *matHeaderCellDef>Size</th>
          <td mat-cell *matCellDef="let pcap"> {{ pcap.size /1000000 | number:'1.0-3' }}</td>
        </ng-container>
        <ng-container matColumnDef="hash">
          <th mat-header-cell *matHeaderCellDef>
            <span *ngIf="showMd5"><a (click)="showMD5()"><b>MD5</b></a>&nbsp;</span>
            <span *ngIf="!showMd5"><a (click)="showMD5()">MD5</a>&nbsp;</span>
            <span *ngIf="showSha1"><a (click)="showSHA1()"><b>SHA1</b></a>&nbsp;</span>
            <span *ngIf="!showSha1"><a (click)="showSHA1()">SHA1</a>&nbsp;</span>
            <span *ngIf="showSha256"><a (click)="showSHA256()"><b>SHA256</b></a>&nbsp;</span>
            <span *ngIf="!showSha256"><a (click)="showSHA256()">SHA256</a>&nbsp;</span>
          </th>
          <td mat-cell *matCellDef="let pcap"> {{ getHash(pcap.hashes) }} </td>
        </ng-container>
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef>Action</th>
          <td mat-cell *matCellDef="let pcap">
            <button mat-button matTooltip="Remove Rule" (click)="openConfirmModal(pcap)">
              <i class="material-icons" style="color:red;">delete</i>
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
        <tr mat-row *matRowDef="let myRowData; columns: displayColumns"></tr>
      </table>
      <mat-paginator #pcapPaginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </mat-card-content>
  </mat-card>
</div>
