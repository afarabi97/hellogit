Hash Master CPT Drive:
  stage: hashfiles
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export create-master-drive-hashes \
    --rsync-source "$MASTER_DRIVE_CREATION_CPT_RSYNC_SOURCE"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"


Hash Master MDT Drive:
  stage: hashfiles
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export create-master-drive-hashes \
    --rsync-source "$MASTER_DRIVE_CREATION_MDT_RSYNC_SOURCE"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"


Hash Check Master CPT Drive:
  stage: checkhash
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export check-master-drive-hashes \
    --rsync-source "$MASTER_DRIVE_CREATION_CPT_RSYNC_SOURCE"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"


Hash Check Master MDT Drive:
  stage: checkhash
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export check-master-drive-hashes \
    --rsync-source "$MASTER_DRIVE_CREATION_MDT_RSYNC_SOURCE"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"


Create Master CPT Drive:
  stage: publish
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export create-master-drive \
    --multi-boot-img-path "$MASTER_DRIVE_CREATION_MULTIBOOT_IMG_PATH" \
    --external-drive "$MASTER_DRIVE_CREATION_EXTERNAL_CPT_DRIVE" \
    --mount-point "$MASTER_DRIVE_CREATION_CPT_MOUNT_POINT" \
    --rsync-source "$MASTER_DRIVE_CREATION_CPT_RSYNC_SOURCE" \
    --username "$MASTER_DRIVE_CREATION_USERNAME" \
    --password "$MASTER_DRIVE_CREATION_PASSWORD" \
    --ipaddress "$MASTER_DRIVE_CREATION_IPADDRESS"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"


Create Master MDT Drive:
  stage: publish
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py run-export create-master-drive \
    --multi-boot-img-path "$MASTER_DRIVE_CREATION_MULTIBOOT_IMG_PATH" \
    --external-drive "$MASTER_DRIVE_CREATION_EXTERNAL_MDT_DRIVE" \
    --mount-point "$MASTER_DRIVE_CREATION_MDT_MOUNT_POINT" \
    --rsync-source "$MASTER_DRIVE_CREATION_MDT_RSYNC_SOURCE" \
    --username "$MASTER_DRIVE_CREATION_USERNAME" \
    --password "$MASTER_DRIVE_CREATION_PASSWORD" \
    --ipaddress "$MASTER_DRIVE_CREATION_IPADDRESS"
  only:
    variables:
      - $RUN_CREATE_MASTER_DRIVE == "true"
