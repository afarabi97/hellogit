Clear DIP Docs Folders:
  stage: pre-build
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I)"
    echo "Current working directory is $(pwd)"

    echo "$DOCS_FOLDERS"
    for folder in $DOCS_FOLDERS
    do
      echo "$DIP_CPT_DOC_EXPORT_LOC/$folder"
      rm -f "$DIP_CPT_DOC_EXPORT_LOC/$folder"/*
      mkdir -p "$DIP_CPT_DOC_EXPORT_LOC/$folder/"

      rm -f "$DIP_MDT_DOC_EXPORT_LOC/$folder"/*
      mkdir -p "$DIP_MDT_DOC_EXPORT_LOC/$folder/"
    done
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


Build DIP Offline Documentation:
  stage: build
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I)"
    echo "Current working directory is $(pwd)"
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-html-docs \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-title "$TFPLENUM_CONFLUENCE_PAGE"
  retry: 2
  artifacts:
    untracked: true
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP Setup Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_SETUP_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_SETUP_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_SETUP_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP User Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_USER_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_USER_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_USER_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP Training Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_TRAINING_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_TRAINING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_TRAINING_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP Architecture Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_ARCH_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_ARCH_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_ARCH_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP Maintenance Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_MAINTENANCE_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_MAINTENANCE_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_MAIN_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"

DIP TroubleShooting Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_TROUBLESHOOTING_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_TROUBLESHOOTING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_TROUBLE_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"


DIP VDD Documents:
  stage: docs
  needs: ["Clear DIP Docs Folders"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$DIP_CPT_DOC_EXPORT_LOC/$DOCS_VDD_FOLDER" \
    --mdt-export-path "$DIP_MDT_DOC_EXPORT_LOC/$DOCS_VDD_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --export-hash "$TFPLENUM_EXPORT_HASH" \
    --page-titles "$DIP_CONFLUENCE_VDD_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-dip"
      - $PIPELINE == "export-all"
