DIP Robot Tests:
  stage: robot-test
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I)"
    echo "Current working directory is $(pwd)"
    CONFLUENCE_PASSWORD_DECRYPTED=$(echo "$CONFLUENCE_PASSWORD" | base64 -d)
    mkdir -p $PATHPWD/tests/dip_test_suite/
    python3 testing/pipeline/pipeline.py run-robot \
    --tfplenum-robot-container "docker.nexus.sil.lab/tfplenum/robot-automator:1.5.4" \
    --jira-username "$CONFLUENCE_USERNAME" \
    --jira-password "$CONFLUENCE_PASSWORD_DECRYPTED" \
    --jira-report $ROBOT_REGRESSION_ZEPHYR_CYCLE \
    --jira-project-version $ROBOT_REGRESSION_ZEPHYR_PROJECT_VERSION \
    --jira-project-key "$JIRA_PROJECT_KEY" \
    --robot-browser $ROBOT_BROWSER \
    --robot-category $ROBOT_REGRESSION_CATEGORY \
    --domain "$KIT_DOMAIN" \
    --kit-version "$TFPLENUM_EXPORT_VERSION" \
    --pipeline "$PIPELINE"
  artifacts:
    untracked: true
    when: always
  only:
    variables:
      - $RUN_ROBOT_TESTS == "yes" && $PIPELINE == "developer-all"
