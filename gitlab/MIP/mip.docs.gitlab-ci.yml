# Build MIP Offline Documentation:
#   stage: build
#   tags:
#     - tfplenum-buildv2
#   script: |
#     echo "IP of runner is $(hostname -I | cut -d " " -f1)"
#     echo "Current working directory is $(pwd)"
#     python3 testing/pipeline/pipeline.py \
#     run-export export-html-docs \
#     --username "$CONFLUENCE_USERNAME" \
#     --password "$CONFLUENCE_PASSWORD" \
#     --cpt-export-path "$MIP_CPT_DOC_EXPORT_LOC" \
#     --mdt-export-path "$MIP_MDT_DOC_EXPORT_LOC" \
#     --staging-export-path "$DRIVE_STAGING_FOLDER" \
#     --export-version "$TFPLENUM_EXPORT_VERSION" \
#     --page-title "$TFPLENUM_CONFLUENCE_PAGE"
#   retry: 2
#   artifacts:
#     untracked: true
#   only:
#     variables:
#       - $PIPELINE == "export-all"
#       - $PIPELINE == "export-docs"


MIP Setup Documents:
  stage: docs
  needs: ["Clear Staging Environment", "Build CPT Manifest", "Build MDT Manifest"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$MIP_CPT_DOC_EXPORT_LOC/" \
    --mdt-export-path "$MIP_MDT_DOC_EXPORT_LOC/" \
    --staging-export-path "$DRIVE_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --page-titles "$MIP_CONFLUENCE_SETUP_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-all"


MIP User Documents:
  stage: docs
  needs: ["Clear Staging Environment", "Build CPT Manifest", "Build MDT Manifest"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$MIP_CPT_DOC_EXPORT_LOC/" \
    --mdt-export-path "$MIP_MDT_DOC_EXPORT_LOC/" \
    --staging-export-path "$DRIVE_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --page-titles "$MIP_CONFLUENCE_USER_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-all"


MIP Maintenance Documents:
  stage: docs
  needs: ["Clear Staging Environment", "Build CPT Manifest", "Build MDT Manifest"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$MIP_CPT_DOC_EXPORT_LOC/" \
    --mdt-export-path "$MIP_MDT_DOC_EXPORT_LOC/" \
    --staging-export-path "$DRIVE_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --page-titles "$MIP_CONFLUENCE_MAIN_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-all"


MIP TroubleShooting Documents:
  stage: docs
  needs: ["Clear Staging Environment", "Build CPT Manifest", "Build MDT Manifest"]
  tags:
    - tfplenum-buildv2
  script: |
    python3 testing/pipeline/pipeline.py \
    run-export export-single-page-pdf \
    --username "$CONFLUENCE_USERNAME" \
    --password "$CONFLUENCE_PASSWORD" \
    --cpt-export-path "$MIP_CPT_DOC_EXPORT_LOC/" \
    --mdt-export-path "$MIP_MDT_DOC_EXPORT_LOC/" \
    --staging-export-path "$DRIVE_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION" \
    --page-titles "$MIP_CONFLUENCE_TROUBLE_DOCS"
  retry: 2
  only:
    variables:
      - $PIPELINE == "export-docs"
      - $PIPELINE == "export-all"
