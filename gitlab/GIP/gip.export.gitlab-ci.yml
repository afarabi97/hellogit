Export GIP Service VM:
  stage: export
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I | cut -d " " -f1)"
    echo "Current working directory is $(pwd)"
    python3 testing/pipeline/pipeline.py \
    --system-name "GIP" \
    run-export export-gip-service-vm \
    --cpt-export-path "$GIP_EXPORT_LOC" \
    --staging-export-path "$DRIVE_GIP_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION"
  only:
    variables:
      - $PIPELINE == "export-gip"
  artifacts:
    untracked: true

Export GIP Controller:
  stage: export
  needs: ["Setup GIP Controller"]
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I | cut -d " " -f1)"
    echo "Current working directory is $(pwd)"
    python3 testing/pipeline/pipeline.py \
    --system-name "GIP" \
    run-export export-ctrl \
    --cpt-export-path "$GIP_EXPORT_LOC" \
    --staging-export-path "$DRIVE_GIP_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION"
  only:
    variables:
      - $PIPELINE == "export-gip"

Export GIP MinIO:
  stage: export
  needs: ["Create a standalone MinIO server"]
  tags:
    - tfplenum-buildv2
  script: |
    echo "IP of runner is $(hostname -I | cut -d " " -f1)"
    echo "Current working directory is $(pwd)"
    python3 testing/pipeline/pipeline.py \
    --system-name "DIP" \
    run-export minio \
    --cpt-export-path "$GIP_EXPORT_LOC" \
    --staging-export-path "$DRIVE_GIP_STAGING_FOLDER" \
    --export-version "$TFPLENUM_EXPORT_VERSION"
  only:
    variables:
      - $PIPELINE == "export-gip"
